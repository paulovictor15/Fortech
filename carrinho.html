<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finalizar Compra - Fortech</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>Fortech</h1>
        <nav>
            <ul>
                <li><a href="index.html">In√≠cio</a></li>
                <li><a href="produtos.html">Produtos</a></li>
                <li><a href="categorias.html">Categorias</a></li>
                <li><a href="carrinho.html" id="carrinho-link">üõí Carrinho (<span id="contador-carrinho">0</span>)</a></li>
                <li><a href="contato.html">Contato</a></li>
            </ul>
        </nav>
    </header>

    <main class="main-content">
        <h3>üõí Seus Produtos</h3>
<div id="itens-carrinho"></div>

<hr>
        <h2>üîí Finaliza√ß√£o da Compra</h2>
        <form id="form-checkout">
            <h3>1. Endere√ßo de Entrega</h3>
            <input type="text" placeholder="Nome Completo" required>
            <input type="email" placeholder="E-mail" required>
            <input type="text" placeholder="CEP" required>
            
            <h3>2. Pagamento</h3>
            <select required>
                <option value="">Selecione o M√©todo de Pagamento</option>
                <option value="cartao">Cart√£o de Cr√©dito</option>
                <option value="pix">PIX</option>
                <option value="boleto">Boleto Banc√°rio</option>
            </select>

            <button type="submit" id="btn-pagar">Pagar Agora</button>
        </form>
    </main>

    <footer>
        <p>&copy; 2025 Fortech - Todos os direitos reservados | <a href="politica.html">Pol√≠tica de Privacidade</a></p>
    </footer>

 <script>
    // Recupera o carrinho salvo
    let carrinho = JSON.parse(localStorage.getItem("carrinho")) || [];
    let lista = document.getElementById("itens-carrinho");

    function atualizarCarrinho() {
        lista.innerHTML = ""; // limpa

        if (carrinho.length === 0) {
            lista.innerHTML = "<p>Seu carrinho est√° vazio.</p>";
            return;
        }

        let total = 0;

        carrinho.forEach((item, index) => {
            // Converte pre√ßo "R$ 14,99" ‚Üí 14.99
            let precoNumerico = Number(item.preco.replace("R$", "").replace(",", "."));
            total += precoNumerico;

            let div = document.createElement("div");
            div.classList.add("item-carrinho");
            div.style.display = "flex";
            div.style.alignItems = "center";
            div.style.gap = "20px";
            div.style.marginBottom = "15px";

            div.innerHTML = `
                <img src="${item.imagem}" width="80" height="80" style="border-radius:8px; border:1px solid #ccc;">
                <div style="flex:1">
                    <h4>${item.nome}</h4>
                    <p>${item.preco}</p>
                </div>
                <button class="remover" data-index="${index}" style="
                    padding: 8px 12px;
                    background:red;
                    color:white;
                    border:none;
                    cursor:pointer;
                    border-radius:5px;
                ">‚úñ</button>
            `;

            lista.appendChild(div);
        });

        // Mostra o total
        let totalDiv = document.createElement("h3");
        totalDiv.textContent = "Total: R$ " + total.toFixed(2).replace(".", ",");
        lista.appendChild(totalDiv);

        // Bot√£o de remover item
        document.querySelectorAll(".remover").forEach(btn => {
            btn.addEventListener("click", function () {
                let index = this.getAttribute("data-index");
                carrinho.splice(index, 1);
                localStorage.setItem("carrinho", JSON.stringify(carrinho));
                atualizarCarrinho();
            });
        });
    }

    atualizarCarrinho();
</script>
<script>
// ‚≠ê 1. CEP SOMENTE N√öMEROS E COM 8 D√çGITOS
const cepInput = document.querySelector('input[placeholder="CEP"]');

cepInput.addEventListener("input", function() {
    // Remove tudo que N√ÉO for n√∫mero
    this.value = this.value.replace(/\D/g, "");

    // Limita o tamanho para 8 n√∫meros (CEP paulista e padr√£o nacional)
    if (this.value.length > 8) {
        this.value = this.value.slice(0, 8);
    }
});

// ‚≠ê 2. FINALIZAR COMPRA ‚Äì LIMPAR CARRINHO AO CLICAR EM PAGAR
document.getElementById("form-checkout").addEventListener("submit", function(e) {
    e.preventDefault(); // Impede o envio imediato

    // Verificar se CEP tem 8 d√≠gitos
    if (cepInput.value.length !== 8) {
        alert("CEP inv√°lido! Digite exatamente 8 n√∫meros.");
        return;
    }

    // Limpa o carrinho
    localStorage.removeItem("carrinho");

    // Atualiza a lista na tela
    document.getElementById("itens-carrinho").innerHTML = "<p>Carrinho vazio!</p>";

    // Atualiza contador no menu
    document.getElementById("contador-carrinho").textContent = "0";

    // Mensagem de confirma√ß√£o
    alert("üéâ Compra finalizada com sucesso! Obrigado por comprar conosco.");

    // Aqui voc√™ pode redirecionar se quiser:
    // window.location.href = "index.html";
});
</script>

</body>
</html>
